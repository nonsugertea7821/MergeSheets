# 外部設計書 - Excelシート統合マクロ

## 1. 画面設計（MergeSheetsシート）

| 項目 | セル | 入力形式 | 説明 |
|------|------|---------|------|
| 統合先ブック | B4 | フルパス文字列 | 統合対象ブックのフルパスを指定 |
| 統合元ルートフォルダ | B5 | フォルダパス文字列 | 統合元フォルダを指定（サブフォルダ含む） |
| 同名シート上書き | B6 | TRUE/FALSE | TRUEの場合、同名シートを上書き。FALSEの場合はエラー |

---

## 2. 操作手順
1. MergeSheetsシートのB4～B7に設定を入力
2. マクロ「MergeSheets」を実行
3. 統合先ブックのコピーが日付フォルダに作成される
4. 「Results」シートで統合結果を確認
5. エラー発生時はメッセージを確認し、必要に応じて設定を修正して再実行

---

## 3. 入出力仕様

| 入力 | 出力 | 備考 |
|------|------|------|
| 統合先ブックパス | マージ済みブック | 日付フォルダに `_merged_yyyymmdd_hhnnss.xlsx` として保存 |
| 統合元フォルダパス | 統合結果シート | シート名、統合状態、統合元パスを記録 |
| 上書き設定 | - | TRUEで同名シート上書き、FALSEでエラー |

---

## 4. エラー仕様

| エラー | 発生条件 | メッセージ | 対処 |
|--------|-----------|------------|------|
| 統合先ロック存在 | 統合先ブックが開かれているかロックファイルあり | 「統合先ブックが開かれているか、ロックファイルが存在します。」 | 統合先ブックを閉じる |
| シート重複 | 同名シート存在かつ上書きOFF | 「統合中にシート名の重複が発生しました。」 | 上書き設定をTRUEにする |
| 統合対象ブックなし | 指定した統合先ブックが存在しない | 「統合対象ブックが存在しません。」 | 統合先ブックパスを確認 |
| 予期せぬエラー | 想定外の例外発生 | 「統合処理中に予期せぬエラーが発生しました。」 | 詳細メッセージ確認 |
