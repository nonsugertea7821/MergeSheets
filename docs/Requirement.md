# 要件定義書 - Excelシート統合マクロ

## 1. システム概要
本システムは、指定フォルダ以下に存在する複数のExcelブックのシートを収集し、指定された統合先ブックに統合するVBAマクロです。  
統合結果は「Results」シートに記録され、処理状況や上書き状態などを可視化できます。

### 1.1 目的
- 複数のExcelファイルのシートを一括で統合することによる作業効率化
- 統合時の重複やエラーを検知・記録し、安全に統合作業を行う

### 1.2 背景
- 現場でExcelファイルのシート統合作業が手動で行われており、作業時間が長く、ヒューマンエラーが発生する
- 統合履歴を自動記録し、再現性を確保する必要がある

---

## 2. 対象ユーザー
- Excelでデータ管理を行う業務担当者
- 日次・週次など定期的に複数ブックのシートを統合する必要があるユーザー

---

## 3. 要件一覧

| 要件ID | 要件概要 | 詳細 |
|--------|----------|------|
| RF01 | 統合先ブック指定 | 統合先ブックのフルパスを設定し、統合対象のシートを追加 |
| RF02 | 統合元フォルダ指定 | 統合元となるフォルダを指定。サブフォルダも再帰的に検索対象 |
| RF03 | シート上書き制御 | 同名シートが存在する場合、上書きするか選択可能（TRUE/FALSE） |
| RF04 | 統合結果出力 | 統合結果を「Results」シートに記録。項目はシート名、状態（追加/上書き）、統合元パス |
| RF05 | 保存先制御 | 統合先ブックをコピーして、日付フォルダに `_merged_yyyymmdd_hhnnss.xlsx` 形式で保存 |
| RF06 | エラー検知 | 統合先が開かれている場合や重複が発生した場合に適切にエラー通知 |
| RF07 | 処理履歴保持 | 過去の統合処理の結果を保持し、再実行時も更新可能 |

---

## 4. 制約条件
- 統合元フォルダ内のExcelファイルは `xls` または `xlsx` のみ対象
- 統合先ブックが開いている場合は処理を停止
- 上書き設定がFALSEの場合、同名シートがあると統合処理を停止
- 統合元シートの内容はコピーのみで変更しない

---

## 5. 成功条件
- 統合対象フォルダ内の全シートが統合先ブックに正しく追加されること
- 「Results」シートに全てのシート統合結果が記録されること
- 上書きやロック無視の設定が正しく反映されること
