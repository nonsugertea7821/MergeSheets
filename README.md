# Excelシート統合マクロ

## 概要

このVBAマクロは、指定フォルダ内の複数のExcelブックのシートを収集し、指定された統合先ブックにまとめるためのツールです。
統合結果は「Results」シートに記録され、処理状況や上書き状態を可視化できます。

* 複数ファイルのシート統合による作業効率化
* 統合履歴の自動記録による再現性確保
* エラー検知と安全な統合作業

---

## 対象ユーザー

* Excelでデータ管理を行う業務担当者
* 定期的に複数ブックのシートを統合する必要がある方

---

## 主な機能

| 機能        | 説明                                                       |
| --------- | -------------------------------------------------------- |
| 統合先ブック指定  | 統合先ブックのフルパスを設定し、統合対象のシートを追加                              |
| 統合元フォルダ指定 | 統合元フォルダを指定。サブフォルダも再帰的に検索対象                               |
| シート上書き制御  | 同名シートが存在する場合、上書き可否を設定可能（TRUE/FALSE）                      |
| 統合結果出力    | 「Results」シートに統合結果を記録（シート名、状態、統合元パス）                      |
| 保存先制御     | 統合先ブックをコピーし、日付フォルダに `_merged_yyyymmdd_hhnnss.xlsx` 形式で保存 |
| エラー検知     | 統合先が開かれている場合や重複発生時にエラー通知                                 |
| 処理履歴保持    | 過去の統合処理結果を保持し、再実行時も更新可能                                  |

---

## 制約条件

* 統合元ファイルは `xls` または `xlsx` のみ対象
* 統合先ブックが開いている場合は処理を停止
* 上書き設定がFALSEの場合、同名シートがあると処理を停止
* 統合元シートの内容はコピーのみで変更しない

---

## 成功条件

* 統合対象フォルダ内の全シートが統合先ブックに正しく追加されること
* 「Results」シートに全ての統合結果が記録されること
* 上書きやロック無視の設定が正しく反映されること

---

## 使い方

1. **統合先ブックと統合元フォルダを設定**
   VBAマクロ内の変数でパスを指定します。

2. **上書き設定を選択**

   * TRUE: 同名シートを上書き
   * FALSE: 同名シートがある場合は処理停止

3. **マクロを実行**
   統合処理が完了すると「Results」シートに結果が表示されます。

4. **保存**
   処理後、統合先ブックは日付付きファイルとして保存されます。

---

## 注意事項

* 統合先ブックを開いたまま実行しないこと
* 統合元シートの内容は変更されません
* マクロ実行前に必ずバックアップを推奨
